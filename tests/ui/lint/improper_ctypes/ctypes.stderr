error: `repr(C)` type uses type `ZeroSize`, which is not FFI-safe
  --> $DIR/ctypes.rs:28:1
   |
LL | pub struct ZeroSize;
   | ^^^^^^^^^^^^^^^^^^^^ not FFI-safe
   |
   = help: consider adding a member to this struct
   = note: `ZeroSize` has no fields
note: the type is defined here
  --> $DIR/ctypes.rs:28:1
   |
LL | pub struct ZeroSize;
   | ^^^^^^^^^^^^^^^^^^^
note: the lint level is defined here
  --> $DIR/ctypes.rs:8:36
   |
LL | #![deny(improper_c_fn_definitions, improper_ctype_definitions)]
   |                                    ^^^^^^^^^^^^^^^^^^^^^^^^^^

error: `repr(C)` type uses type `dyn Debug`, which is not FFI-safe
  --> $DIR/ctypes.rs:55:1
   |
LL | / pub struct UnsizedStructBecauseDyn {
LL | |
LL | |     sized: u32,
LL | |     unszd: dyn Debug,
LL | | }
   | |_^ not FFI-safe
   |
   = note: trait objects have no C equivalent

error: `repr(C)` type uses type `char`, which is not FFI-safe
  --> $DIR/ctypes.rs:62:1
   |
LL | / pub struct TwoBadTypes<'a> {
LL | |
LL | |
LL | |     non_c_type: char,
LL | |     ref_with_mdata: &'a [u8],
LL | | }
   | |_^ not FFI-safe
   |
   = help: consider using `u32` or `libc::wchar_t` instead
   = note: the `char` type has no C equivalent

error: `repr(C)` type uses type `&[u8]`, which is not FFI-safe
  --> $DIR/ctypes.rs:62:1
   |
LL | / pub struct TwoBadTypes<'a> {
LL | |
LL | |
LL | |     non_c_type: char,
LL | |     ref_with_mdata: &'a [u8],
LL | | }
   | |_^ not FFI-safe
   |
   = help: consider using a raw pointer to the slice's first element (and a length) instead
   = note: this reference to an unsized type contains metadata, which makes it incompatible with a C pointer

error: `extern` block uses type `&[u32]`, which is not FFI-safe
  --> $DIR/ctypes.rs:77:26
   |
LL |     pub fn slice_type(p: &[u32]);
   |                          ^^^^^^ not FFI-safe
   |
   = help: consider using a raw pointer to the slice's first element (and a length) instead
   = note: this reference to an unsized type contains metadata, which makes it incompatible with a C pointer
note: the lint level is defined here
  --> $DIR/ctypes.rs:7:9
   |
LL | #![deny(improper_ctypes, improper_c_callbacks)]
   |         ^^^^^^^^^^^^^^^

error: `extern` block uses type `&str`, which is not FFI-safe
  --> $DIR/ctypes.rs:78:24
   |
LL |     pub fn str_type(p: &str);
   |                        ^^^^ not FFI-safe
   |
   = help: consider using `*const u8` and a length instead
   = note: this reference to an unsized type contains metadata, which makes it incompatible with a C pointer

error: `extern` block uses type `char`, which is not FFI-safe
  --> $DIR/ctypes.rs:81:25
   |
LL |     pub fn char_type(p: char);
   |                         ^^^^ not FFI-safe
   |
   = help: consider using `u32` or `libc::wchar_t` instead
   = note: the `char` type has no C equivalent

error: `extern` block uses type `i128`, which is not FFI-safe
  --> $DIR/ctypes.rs:82:25
   |
LL |     pub fn i128_type(p: i128);
   |                         ^^^^ not FFI-safe
   |
   = note: 128-bit integers don't currently have a known stable ABI

error: `extern` block uses type `u128`, which is not FFI-safe
  --> $DIR/ctypes.rs:83:25
   |
LL |     pub fn u128_type(p: u128);
   |                         ^^^^ not FFI-safe
   |
   = note: 128-bit integers don't currently have a known stable ABI

error: `extern` block uses type `(u32) is 1..`, which is not FFI-safe
  --> $DIR/ctypes.rs:84:27
   |
LL |     pub fn pat_type1() -> pattern_type!(u32 is 1..);
   |                           ^^^^^^^^^^^^^^^^^^^^^^^^^ not FFI-safe
   |
   = help: consider using the base type instead
   = note: integers constrained to a given range cannot have their value be provided by non-rust code

error: `extern` block uses type `&dyn Bar`, which is not FFI-safe
  --> $DIR/ctypes.rs:86:26
   |
LL |     pub fn trait_type(p: &dyn Bar);
   |                          ^^^^^^^^ not FFI-safe
   |
   = note: this reference to an unsized type contains metadata, which makes it incompatible with a C pointer

error: `extern` block uses type `(i32, i32)`, which is not FFI-safe
  --> $DIR/ctypes.rs:87:26
   |
LL |     pub fn tuple_type(p: (i32, i32));
   |                          ^^^^^^^^^^ not FFI-safe
   |
   = help: consider using a struct instead
   = note: tuples have unspecified layout

error: `extern` block uses type `(i32, i32)`, which is not FFI-safe
  --> $DIR/ctypes.rs:88:27
   |
LL |     pub fn tuple_type2(p: I32Pair);
   |                           ^^^^^^^ not FFI-safe
   |
   = help: consider using a struct instead
   = note: tuples have unspecified layout

error: `extern` block uses type `ZeroSize`, which is not FFI-safe
  --> $DIR/ctypes.rs:89:25
   |
LL |     pub fn zero_size(p: ZeroSize);
   |                         ^^^^^^^^ not FFI-safe
   |
   = help: consider adding a member to this struct
   = note: `ZeroSize` has no fields
note: the type is defined here
  --> $DIR/ctypes.rs:28:1
   |
LL | pub struct ZeroSize;
   | ^^^^^^^^^^^^^^^^^^^

error: `extern` block uses type `ZeroSizeWithPhantomData`, which is not FFI-safe
  --> $DIR/ctypes.rs:90:33
   |
LL |     pub fn zero_size_phantom(p: ZeroSizeWithPhantomData);
   |                                 ^^^^^^^^^^^^^^^^^^^^^^^ not FFI-safe
   |
   = note: composed only of `PhantomData`
note: the type is defined here
  --> $DIR/ctypes.rs:70:1
   |
LL | pub struct ZeroSizeWithPhantomData(::std::marker::PhantomData<i32>);
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

error: `extern` block uses type `PhantomData<bool>`, which is not FFI-safe
  --> $DIR/ctypes.rs:93:12
   |
LL |         -> ::std::marker::PhantomData<bool>;
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ not FFI-safe
   |
   = note: composed only of `PhantomData`

error: `extern` block uses type `fn()`, which is not FFI-safe
  --> $DIR/ctypes.rs:94:23
   |
LL |     pub fn fn_type(p: RustFn);
   |                       ^^^^^^ not FFI-safe
   |
   = help: consider using an `extern fn(...) -> ...` function pointer instead
   = note: this function pointer has Rust-specific calling convention

error: `extern` block uses type `fn()`, which is not FFI-safe
  --> $DIR/ctypes.rs:95:24
   |
LL |     pub fn fn_type2(p: fn());
   |                        ^^^^ not FFI-safe
   |
   = help: consider using an `extern fn(...) -> ...` function pointer instead
   = note: this function pointer has Rust-specific calling convention

error: `extern` block uses type `TransparentI128`, which is not FFI-safe
  --> $DIR/ctypes.rs:97:32
   |
LL |     pub fn transparent_i128(p: TransparentI128);
   |                                ^^^^^^^^^^^^^^^ not FFI-safe
   |
   = note: this struct/enum/union (`TransparentI128`) is FFI-unsafe due to a `i128` field
note: the type is defined here
  --> $DIR/ctypes.rs:34:1
   |
LL | pub struct TransparentI128(i128);
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^
   = note: 128-bit integers don't currently have a known stable ABI

error: `extern` block uses type `TransparentStr`, which is not FFI-safe
  --> $DIR/ctypes.rs:98:31
   |
LL |     pub fn transparent_str(p: TransparentStr);
   |                               ^^^^^^^^^^^^^^ not FFI-safe
   |
   = note: this struct/enum/union (`TransparentStr`) is FFI-unsafe due to a `&str` field
note: the type is defined here
  --> $DIR/ctypes.rs:36:1
   |
LL | pub struct TransparentStr(&'static str);
   | ^^^^^^^^^^^^^^^^^^^^^^^^^
   = help: consider using `*const u8` and a length instead
   = note: this reference to an unsized type contains metadata, which makes it incompatible with a C pointer

error: `extern` block uses type `[u8; 8]`, which is not FFI-safe
  --> $DIR/ctypes.rs:100:27
   |
LL |     pub fn raw_array(arr: [u8; 8]);
   |                           ^^^^^^^ not FFI-safe
   |
   = help: consider passing a pointer to the array
   = note: passing raw arrays by value is not FFI-safe

error: `extern` callback uses type `char`, which is not FFI-safe
  --> $DIR/ctypes.rs:102:12
   |
LL |         f: for<'a> extern "C" fn(a:char, b:&dyn Debug, c: TwoBadTypes<'a>)
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ not FFI-safe
   |
   = note: the function pointer to `for<'a, 'b> extern "C" fn(char, &'a (dyn Debug + 'a), TwoBadTypes<'b>)` is FFI-unsafe due to `char`
   = help: consider using `u32` or `libc::wchar_t` instead
   = note: the `char` type has no C equivalent
note: the lint level is defined here
  --> $DIR/ctypes.rs:7:26
   |
LL | #![deny(improper_ctypes, improper_c_callbacks)]
   |                          ^^^^^^^^^^^^^^^^^^^^

error: `extern` callback uses type `&dyn Debug`, which is not FFI-safe
  --> $DIR/ctypes.rs:102:12
   |
LL |         f: for<'a> extern "C" fn(a:char, b:&dyn Debug, c: TwoBadTypes<'a>)
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ not FFI-safe
   |
   = note: the function pointer to `for<'a, 'b> extern "C" fn(char, &'a (dyn Debug + 'a), TwoBadTypes<'b>)` is FFI-unsafe due to `&dyn Debug`
   = note: this reference to an unsized type contains metadata, which makes it incompatible with a C pointer

error: `extern` callback uses type `TwoBadTypes<'_>`, which is not FFI-safe
  --> $DIR/ctypes.rs:102:12
   |
LL |         f: for<'a> extern "C" fn(a:char, b:&dyn Debug, c: TwoBadTypes<'a>)
   |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ not FFI-safe
   |
   = note: the function pointer to `for<'a, 'b> extern "C" fn(char, &'a (dyn Debug + 'a), TwoBadTypes<'b>)` is FFI-unsafe due to `TwoBadTypes<'_>`
   = note: this struct/enum/union (`TwoBadTypes<'_>`) is FFI-unsafe due to a `&[u8]` field
note: the type is defined here
  --> $DIR/ctypes.rs:62:1
   |
LL | pub struct TwoBadTypes<'a> {
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^
   = help: consider using a raw pointer to the slice's first element (and a length) instead
   = note: this reference to an unsized type contains metadata, which makes it incompatible with a C pointer

error: `extern` block uses type `&UnsizedStructBecauseDyn`, which is not FFI-safe
  --> $DIR/ctypes.rs:109:47
   |
LL |     pub fn struct_unsized_ptr_has_metadata(p: &UnsizedStructBecauseDyn);
   |                                               ^^^^^^^^^^^^^^^^^^^^^^^^ not FFI-safe
   |
   = note: this reference to an unsized type contains metadata, which makes it incompatible with a C pointer

error: `extern` block uses type `Option<UnsafeCell<extern "C" fn()>>`, which is not FFI-safe
  --> $DIR/ctypes.rs:111:26
   |
LL |     pub fn no_niche_a(a: Option<UnsafeCell<extern "C" fn()>>);
   |                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ not FFI-safe
   |
   = help: consider adding a `#[repr(C)]`, `#[repr(transparent)]`, or integer `#[repr(...)]` attribute to this enum
   = note: enum has no representation hint

error: `extern` block uses type `Option<UnsafeCell<&i32>>`, which is not FFI-safe
  --> $DIR/ctypes.rs:113:26
   |
LL |     pub fn no_niche_b(b: Option<UnsafeCell<&i32>>);
   |                          ^^^^^^^^^^^^^^^^^^^^^^^^ not FFI-safe
   |
   = help: consider adding a `#[repr(C)]`, `#[repr(transparent)]`, or integer `#[repr(...)]` attribute to this enum
   = note: enum has no representation hint

error: `extern` block uses type `u128`, which is not FFI-safe
  --> $DIR/ctypes.rs:116:34
   |
LL |     pub static static_u128_type: u128;
   |                                  ^^^^ not FFI-safe
   |
   = note: 128-bit integers don't currently have a known stable ABI

error: `extern` block uses type `u128`, which is not FFI-safe
  --> $DIR/ctypes.rs:117:40
   |
LL |     pub static static_u128_array_type: [u128; 16];
   |                                        ^^^^^^^^^^ not FFI-safe
   |
   = note: 128-bit integers don't currently have a known stable ABI

error: aborting due to 29 previous errors

